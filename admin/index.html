<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self' http://localhost:3000;"
    />
    <title>Admin - Pharmacy System</title>
    <link rel="stylesheet" href="../css/styles.css" />
    <link rel="stylesheet" href="../css/admin.css" />
    <link rel="manifest" href="../manifest.json" />
    <!-- Favicon links -->
    <link rel="icon" type="image/x-icon" href="../favicon_io/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="../favicon_io/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="../favicon_io/favicon-16x16.png" />
    <link rel="apple-touch-icon" href="../favicon_io/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="../favicon_io/android-chrome-192x192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="../favicon_io/android-chrome-512x512.png" />
  </head>
  <body>
    <nav class="main-nav">
      <img src="../images/nhs_trust_logo.png" alt="NHS Trust Logo" class="nhs-logo" />
      <ul>
        <a href="../remote-ordering/ward/index.html" class="nav-link">Ward Orders</a>
        <a href="../remote-ordering/pharmacy/index.html" class="nav-link">Pharmacy Supply</a>
        <a href="../index.html" class="nav-link">Label Generator</a>
        <a href="#" class="nav-link active">Admin</a>
      </ul>
      <div class="user-info">
        <span id="current-user">Not logged in</span>
        <button id="logout-btn" class="logout-button">Logout</button>
      </div>
    </nav>
    <header>
      <div class="nhs-header">
        <div class="header-content">
          <h1>Admin Dashboard</h1>
        </div>
      </div>
    </header>

    <main class="admin-container">
      <div class="admin-sidebar">
        <ul class="admin-menu">
          <li class="active" data-section="user-management">User Management</li>
          <li data-section="system-settings">System Settings</li>
          <li data-section="account-settings">Account Settings</li>
        </ul>
      </div>
      
      <div class="admin-content">
        <!-- User Management Section -->
        <section id="user-management" class="admin-section active">
          <h2>User Management</h2>
          
          <div class="admin-actions">
            <button id="add-user-btn" class="primary-button">Add New User</button>
          </div>
          
          <div class="users-table-container">
            <table class="users-table">
              <thead>
                <tr>
                  <th>Username</th>
                  <th>Email</th>
                  <th>Access Levels</th>
                  <th>Last Login</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="users-table-body">
                <!-- User rows will be populated here -->
              </tbody>
            </table>
          </div>
        </section>
        
        <!-- System Settings Section -->
        <section id="system-settings" class="admin-section">
          <h2>System Settings</h2>
          
          <div class="settings-form">
            <form id="system-settings-form">
              <div class="form-group">
                <label for="system-name">System Name</label>
                <input type="text" id="system-name" name="systemName" value="Pharmacy System" />
              </div>
              
              <div class="form-group">
                <label for="session-timeout">Session Timeout (minutes)</label>
                <input type="number" id="session-timeout" name="sessionTimeout" min="5" max="120" value="30" />
              </div>
              
              <div class="form-actions">
                <button type="submit" class="primary-button">Save Settings</button>
              </div>
            </form>
          </div>
        </section>
        
        <!-- Account Settings Section -->
        <section id="account-settings" class="admin-section">
          <h2>Account Settings</h2>
          
          <div class="settings-form">
            <form id="password-change-form">
              <h3>Change Password</h3>
              
              <div class="form-group">
                <label for="current-password">Current Password</label>
                <input type="password" id="current-password" name="currentPassword" required />
              </div>
              
              <div class="form-group">
                <label for="new-password">New Password</label>
                <input type="password" id="new-password" name="newPassword" required />
              </div>
              
              <div class="form-group">
                <label for="confirm-password">Confirm New Password</label>
                <input type="password" id="confirm-password" name="confirmPassword" required />
              </div>
              
              <div class="form-actions">
                <button type="submit" class="primary-button">Change Password</button>
              </div>
            </form>
          </div>
        </section>
      </div>
    </main>
    
    <!-- Add User Modal -->
    <div id="add-user-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Add New User</h2>
          <span class="close-modal">&times;</span>
        </div>
        <div class="modal-body">
          <form id="add-user-form">
            <div class="form-group">
              <label for="new-username">Username</label>
              <input type="text" id="new-username" name="username" required />
            </div>
            
            <div class="form-group">
              <label for="new-email">Email</label>
              <input type="email" id="new-email" name="email" />
            </div>
            
            <div class="form-group">
              <label for="new-password">Password</label>
              <input type="password" id="new-password" name="password" required />
            </div>
            
            <div class="form-group">
              <label>Access Levels</label>
              <div class="checkbox-group">
                <label>
                  <input type="checkbox" name="access" value="ordering" /> Ordering
                </label>
                <label>
                  <input type="checkbox" name="access" value="pharmacy" /> Pharmacy
                </label>
                <label>
                  <input type="checkbox" name="access" value="admin" /> Admin
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label>Status</label>
              <div class="radio-group">
                <label>
                  <input type="radio" name="isActive" value="true" checked /> Active
                </label>
                <label>
                  <input type="radio" name="isActive" value="false" /> Inactive
                </label>
              </div>
            </div>
            
            <div class="form-actions">
              <button type="submit" class="primary-button">Add User</button>
              <button type="button" class="secondary-button cancel-modal">Cancel</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    
    <!-- Edit User Modal -->
    <div id="edit-user-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Edit User</h2>
          <span class="close-modal">&times;</span>
        </div>
        <div class="modal-body">
          <form id="edit-user-form">
            <input type="hidden" id="edit-user-id" name="userId" />
            
            <div class="form-group">
              <label for="edit-username">Username</label>
              <input type="text" id="edit-username" name="username" required />
            </div>
            
            <div class="form-group">
              <label for="edit-email">Email</label>
              <input type="email" id="edit-email" name="email" />
            </div>
            
            <div class="form-group">
              <label>Access Levels</label>
              <div class="checkbox-group">
                <label>
                  <input type="checkbox" name="access" value="ordering" /> Ordering
                </label>
                <label>
                  <input type="checkbox" name="access" value="pharmacy" /> Pharmacy
                </label>
                <label>
                  <input type="checkbox" name="access" value="admin" /> Admin
                </label>
              </div>
            </div>
            
            <div class="form-group">
              <label>Status</label>
              <div class="radio-group">
                <label>
                  <input type="radio" name="isActive" value="true" /> Active
                </label>
                <label>
                  <input type="radio" name="isActive" value="false" /> Inactive
                </label>
              </div>
            </div>
            
            <div class="form-actions">
              <button type="submit" class="primary-button">Save Changes</button>
              <button type="button" class="secondary-button cancel-modal">Cancel</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    
    <!-- Reset Password Modal -->
    <div id="reset-password-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Reset Password</h2>
          <span class="close-modal">&times;</span>
        </div>
        <div class="modal-body">
          <form id="reset-password-form">
            <input type="hidden" id="reset-user-id" name="userId" />
            
            <p>Reset password for: <span id="reset-username"></span></p>
            
            <div class="form-group">
              <label for="reset-new-password">New Password</label>
              <input type="password" id="reset-new-password" name="newPassword" required />
            </div>
            
            <div class="form-actions">
              <button type="submit" class="primary-button">Reset Password</button>
              <button type="button" class="secondary-button cancel-modal">Cancel</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script src="../js/api-client.js"></script>
    <script src="../js/secure-user-manager.js"></script>
    <script src="../js/secure-admin.js"></script>
  </body>
</html>
